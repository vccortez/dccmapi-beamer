\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{dccmapi}[2022/03/11 DCCMAPI metropolis slides]

\RequirePackage{appendixnumberbeamer}
\RequirePackage{xspace}
\RequirePackage{booktabs}
\RequirePackage{graphicx}
\RequirePackage{textpos}

\makeatletter

\setbeamertemplate{title page}{
  \begin{minipage}[b][\paperheight]{\textwidth}
    \ifx\inserttitlegraphic\@empty\else\usebeamertemplate*{title graphic}\fi
    \ifx\insertprogram\@empty\else\usebeamertemplate*{program}\fi
    \vfill%
    \ifx\inserttitle\@empty\else\usebeamertemplate*{title}\fi
    \ifx\insertsubtitle\@empty\else\usebeamertemplate*{subtitle}\fi
    \usebeamertemplate*{title separator}
    \ifx\beamer@shortauthor\@empty\else\usebeamertemplate*{author}\fi
    \ifx\insertauthoremail\@empty\else\usebeamertemplate*{authormail}\fi
    \ifx\insertsupervisor\@empty\else\usebeamertemplate*{supervisor}\fi
    \ifx\insertdate\@empty\else\usebeamertemplate*{date}\fi
    \ifx\insertinstitute\@empty\else\usebeamertemplate*{institute}\fi
    \vfill%
    \vspace*{1mm}
  \end{minipage}
}

\def\titlepage{%
  \usebeamertemplate{title page}%<---
}

\setbeamertemplate{title graphic}{
  \vspace*{2em}%
  \begingroup
    \centering\usebeamercolor[fg]{titlegraphic}\inserttitlegraphic\par
  \endgroup
  \nointerlineskip%
}

\newcommand\authormail[1]{
  \def\insertauthoremail{#1}
}
\authormail{}

\newcommand\supervisor[1]{
  \def\insertsupervisor{#1}
}
\supervisor{}

\newcommand\program[1]{
  \def\insertprogram{#1}
}
\program{}

\newcommand\framelogo[1]{%
  \def\insertframelogo{#1}%
}
\framelogo{}

\setbeamertemplate{framelogo}{%
  \begin{textblock*}{100mm}(.87\textwidth,-.65cm)%
    \insertframelogo%
    DCCMAPI%
  \end{textblock*}%
}

\setbeamertemplate{authormail}{
  \scriptsize\insertauthoremail%
  \par%
}

\setbeamertemplate{supervisor}{
  \vspace*{1mm}%
  \small\insertsupervisor%
  \par%
}

\setbeamertemplate{program}{
  \vspace*{1mm}%
  \begingroup
    \centering\insertprogram\par%
  \endgroup
}

\addtobeamertemplate{frametitle}{}{%
  \ifx\insertframelogo\@empty\else\usebeamertemplate*{framelogo}\fi}

\addtobeamertemplate{block begin}{}{\vspace*{\lineskip}}

\define@key{beamer@col}{t}[true]{\def\beamer@colmode{t}\def\beamer@colalign{t}\def\beamer@colheadskip{\vskip-1ex\nointerlineskip}}
\def\@listi{
  \leftmargin\leftmargini
  \topsep  0pt
  \parsep  0pt
  \itemsep 0pt
}
\let\@listI\@listi

\addtobeamertemplate{block example begin}{%
  \metroset{block=fill}%
}{}

\addtobeamertemplate{block alerted begin}{%
  \metroset{block=fill}%
}{}

\makeatother

\settowidth{\leftmargini}{\usebeamertemplate{itemize item}}
\addtolength{\leftmargini}{2.5\labelsep}

% DEFAULTS
\program{Doutorado em Ciência da Computação \\ Associação UFMA \& UFPI}
\titlegraphic{\includegraphics[height=1.25cm]{dccmapi-logo}}
\framelogo{\includegraphics[height=.3cm]{dccmapi-logo-silhouette}}
